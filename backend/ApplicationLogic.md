# Бизнес-логика приложения SkateGo

## Общее описание
SkateGo - это платформа для аренды электроскейтбордов. Пользователи могут находить, арендовать и возвращать электроскейтборды через мобильное приложение или веб-интерфейс.

## Основные сущности

### 1. Модель электроскейтборда (SkateboardModel)
**Описание:** Тип/модель электроскейтборда с техническими характеристиками

**Характеристики:**
- **Название модели** - уникальное название модели (например, "Boosted Board V2")
- **Описание** - подробное описание модели, особенности, материалы
- **Максимальная скорость** - максимальная скорость в км/ч (1-200 км/ч)
- **Емкость батареи** - номинальная емкость батареи в Ач (1-1500 Ач)
- **Напряжение батареи** - напряжение батареи в Вольтах (1-150 В)
- **Запас хода** - максимальное расстояние на одном заряде в км (1-200 км)

**Бизнес-правила:**
- Каждая модель должна иметь уникальное название
- Все технические характеристики должны быть положительными числами
- Модели не удаляются, а помечаются как неактивные

### 2. Электроскейтборд (Skateboard)
**Описание:** Конкретный экземпляр электроскейтборда с индивидуальными характеристиками

**Характеристики:**
- **Модель** - связь с типом электроскейтборда
- **Серийный номер** - уникальный идентификатор устройства
- **Исходная ёмкость (Wh)** - изначальная емкость батареи в ватт-часах
- **Текущая макс. ёмкость (Wh)** - реальная максимальная емкость с учетом износа
- **Остаточная ёмкость (Wh)** - текущий уровень заряда в ватт-часах
- **Общий пробег** - общее расстояние, которое проехал электроскейтборд в км
- **Статус** - текущее состояние (доступен, арендован, на обслуживании, сломан)

**Бизнес-правила:**
- Серийный номер должен быть уникальным
- Текущая максимальная емкость не может превышать исходную
- Остаточная емкость не может превышать текущую максимальную
- При достижении определенного пробега (например, 1000 км) электроскейтборд отправляется на обслуживание
- Батарея деградирует со временем: каждые 100 км пробега емкость уменьшается на 1%

**Расчеты батареи:**
- **Здоровье батареи (%)** = (Текущая макс. ёмкость / Исходная ёмкость) × 100
- **Заряд батареи (%)** = (Остаточная ёмкость / Текущая макс. ёмкость) × 100

### 3. Пользователь (User)
**Описание:** Пользователи системы с различными ролями

**Типы пользователей:**
- **Обычный пользователь (C)** - может арендовать электроскейтборды, оставлять отзывы
- **Сотрудник (S)** - может обслуживать электроскейтборды, управлять их состоянием
- **Администратор (A)** - полный доступ к системе

**Характеристики:**
- Имя пользователя, email, имя, фамилия, телефон
- Тип пользователя, активность, дата регистрации

**Бизнес-правила:**
- Имя пользователя должно быть уникальным
- Email может быть пустым, но если указан - должен быть уникальным
- Неактивные пользователи не могут арендовать электроскейтборды

### 4. Местоположение (SkateBoardLocation)
**Описание:** История местоположений электроскейтбордов

**Характеристики:**
- Широта и долгота (координаты GPS)
- Адрес (опционально)
- Временная метка

**Бизнес-правила:**
- Координаты должны быть в допустимых диапазонах
- Каждое обновление местоположения создает новую запись
- Местоположение обновляется каждые 5 минут при движении

### 5. Отзыв (SkateboardReview)
**Описание:** Отзывы пользователей о электроскейтбордах

**Характеристики:**
- Пользователь, оставивший отзыв
- Электроскейтборд
- Оценка от 1.0 до 5.0
- Текст отзыва
- Дата создания и обновления

**Бизнес-правила:**
- Пользователь может оставить только один отзыв на один электроскейтборд
- Отзыв можно редактировать в течение 24 часов после создания
- Оценка должна быть от 1.0 до 5.0 с шагом 0.5

## Основные бизнес-процессы

### 1. Аренда электроскейтборда
**Процесс:**
1. Пользователь находит доступный электроскейтборд на карте
2. Проверяется статус пользователя (активен, нет задолженностей)
3. Проверяется заряд батареи (минимум 20%)
4. Создается запись об аренде
5. Статус электроскейтборда меняется на "арендован"
6. Начинается отсчет времени аренды

**Бизнес-правила:**
- Минимальный заряд для аренды: 20%
- Максимальное время аренды: 24 часа
- Стоимость: 100 рублей в час
- Штраф за превышение времени: 200 рублей в час

### 2. Возврат электроскейтборда
**Процесс:**
1. Пользователь возвращает электроскейтборд в специальную зону
2. Система фиксирует новое местоположение
3. Обновляется пробег электроскейтборда
4. Рассчитывается стоимость аренды
5. Статус меняется на "доступен"
6. Если заряд ниже 10%, статус меняется на "на обслуживании"

**Бизнес-правила:**
- Электроскейтборд должен быть возвращен в специальную зону
- При возврате с зарядом ниже 10% взимается штраф 500 рублей
- Пробег рассчитывается по GPS координатам

### 3. Обслуживание электроскейтборда
**Процесс:**
1. Система автоматически отправляет электроскейтборд на обслуживание при:
   - Заряде ниже 10%
   - Пробеге более 1000 км
   - Получении 3+ отзывов с оценкой ниже 2.0
   - Здоровье батареи ниже 70%
2. Сотрудник проводит диагностику
3. При необходимости заменяется батарея
4. Обновляются характеристики
5. Статус меняется на "доступен"

**Бизнес-правила:**
- Обслуживание занимает 2-4 часа
- Стоимость обслуживания: 1000 рублей
- При замене батареи исходная емкость восстанавливается

### 4. Мониторинг состояния
**Процесс:**
1. Система постоянно отслеживает:
   - Заряд батареи всех электроскейтбордов
   - Здоровье батареи
   - Местоположение
   - Статус
   - Пробег
2. Генерируются уведомления при:
   - Низком заряде (< 10%)
   - Плохом здоровье батареи (< 70%)
   - Долгом отсутствии движения (> 2 часа)
   - Выходе из зоны обслуживания

## Технические особенности

### Батарея (ватт-часы)
- **Единица измерения:** Ватт-часы (Wh) = Ампер-часы (Ah) × Вольты (V)
- **Деградация:** Каждые 100 км пробега емкость уменьшается на 1%
- **Зарядка:** Происходит автоматически при подключении к зарядной станции
- **Время зарядки:** 2-4 часа в зависимости от модели
- **Критический заряд:** 10% - электроскейтборд отправляется на обслуживание
- **Критическое здоровье:** 70% - рекомендуется замена батареи

### GPS и местоположение
- **Частота обновления:** Каждые 5 минут при движении
- **Точность:** ±5 метров
- **Зоны обслуживания:** Определенные области для возврата
- **Геозоны:** Автоматическое определение выхода из зоны обслуживания

### Безопасность
- **Аутентификация:** JWT токены
- **Авторизация:** Роли пользователей
- **Шифрование:** Все данные передаются по HTTPS
- **Логирование:** Все действия пользователей логируются

## Монетизация

### Тарифы
- **Базовый тариф:** 100 рублей/час
- **Дневной тариф:** 800 рублей/день (8+ часов)
- **Недельный тариф:** 4000 рублей/неделя

### Штрафы
- **Превышение времени:** 200 рублей/час
- **Низкий заряд при возврате:** 500 рублей
- **Выход из зоны обслуживания:** 1000 рублей
- **Повреждение:** Стоимость ремонта + 1000 рублей

### Скидки
- **Постоянные клиенты:** 10% скидка после 10 аренд
- **Время суток:** 20% скидка с 22:00 до 6:00
- **Погода:** 15% скидка в дождь

## Аналитика и отчеты

### Метрики
- Количество аренд в день/неделю/месяц
- Среднее время аренды
- Популярные модели
- Доходы и расходы
- Состояние парка электроскейтбордов
- Среднее здоровье батарей

### Отчеты
- Ежедневные отчеты о состоянии парка
- Еженедельные финансовые отчеты
- Месячные аналитические отчеты
- Отчеты о техническом обслуживании
- Отчеты о состоянии батарей